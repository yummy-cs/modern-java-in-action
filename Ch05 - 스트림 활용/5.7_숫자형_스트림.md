# 5.7 μ«μν• μ¤νΈλ¦Ό

μ•μ—μ„ reduce λ©”μ„λ“λ΅ μ¤νΈλ¦Ό μ”μ†μ ν•©μ„ κµ¬ν•λ” μμ λ¥Ό μ‚΄ν΄λ³΄μ•λ‹¤. 

μλ¥Ό λ“¤μ–΄ λ‹¤μμ²λΌ λ©”λ‰΄μ μΉΌλ΅λ¦¬ ν•©κ³„λ¥Ό κ³„μ‚°ν•  μ μλ‹¤.

```java
int calories = menu.stream()
                   .map(Dish::getCalories)
                   .reduce(0, Integer::sum);
```

μ‚¬μ‹¤ μ„ μ½”λ“μ—λ” λ°•μ‹± λΉ„μ©μ΄ μ¨μ–΄μλ‹¤. λ‚΄λ¶€μ μΌλ΅ ν•©κ³„λ¥Ό κ³„μ‚°ν•κΈ° μ „μ— Integerλ¥Ό κΈ°λ³Έν•μΌλ΅ μ–Έλ°•μ‹±ν•΄μ•Ό ν•λ‹¤. λ‹¤μ μ½”λ“μ²λΌ μ§μ ‘ sum λ©”μ„λ“λ¥Ό νΈμ¶ν•  μ μλ‹¤λ©΄ λ” μΆ‹μ§€ μ•μ„κΉ?

```java
int calories = menu.stream()
                   .map(Dish::getCalories)
                   .sum();
```

ν•μ§€λ§ μ„ μ½”λ“μ²λΌ sum λ©”μ„λ“λ¥Ό μ§μ ‘ νΈμ¶ν•  μ μ—†λ‹¤. map λ©”μ„λ“κ°€ `Stream<T>`λ¥Ό μƒμ„±ν•κΈ° λ•λ¬Έμ΄λ‹¤. μ¤νΈλ¦Όμ μ”μ† ν•μ‹μ€ `Integer`μ΄μ§€λ§ μΈν„°νμ΄μ¤μ—λ” sum λ©”μ„λ“κ°€ μ—†λ‹¤. 

κ·Έλ ‡μ§€λ§ λ‹¤ν–‰νλ„ μ¤νΈλ¦Ό API μ«μ μ¤νΈλ¦Όμ„ ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•  μ μλ„λ΅ κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Ό(primitive stream specialization)μ„ μ κ³µν•λ‹¤.

<br>

## π’΅ 5.7.1 κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Ό

μλ°” 8μ—μ„λ” 3κ°€μ§€ κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Όμ„ μ κ³µν•λ‹¤. 

μ¤νΈλ¦Ό APIλ” λ°•μ‹± λΉ„μ©μ„ ν”Όν•  μ μλ„λ΅ `IntStream`, `DoubleStream`, `LongStream`μ„ μ κ³µν•λ‹¤.

κ°κ°μ μΈν„°νμ΄μ¤λ” sum, maxμ™€ κ°™μ΄ μμ£Ό μ‚¬μ©λλ” μ«μ κ΄€λ ¨ λ¦¬λ“€μ‹± μ—°μ‚° μν–‰ λ©”μ„λ“λ¥Ό μ κ³µν•λ‹¤. λν• ν•„μ”ν•  λ• λ‹¤μ‹ κ°μ²΄ μ¤νΈλ¦ΌμΌλ΅ λ³µμ›ν•λ” κΈ°λ¥λ„ μ κ³µν•λ‹¤. 

νΉν™” μ¤νΈλ¦Όμ€ μ¤μ§ λ°•μ‹± κ³Όμ •μ—μ„ μΌμ–΄λ‚λ” ν¨μ¨μ„±κ³Ό κ΄€λ ¨ μμΌλ©°, μ¤νΈλ¦Όμ— μ¶”κ°€ κΈ°λ¥μ„ μ κ³µν•μ§€ μ•λ”λ‹¤.

<br>

### π“ μ«μ μ¤νΈλ¦ΌμΌλ΅ λ§¤ν•‘

μ¤νΈλ¦Όμ„ νΉν™” μ¤νΈλ¦ΌμΌλ΅ λ³€ν™ν•  λ•λ” `mapToInt`, `mapToDouble`, `mapToLong` μ„Έ κ°€μ§€ λ©”μ„λ“λ¥Ό κ°€μ¥ λ§μ΄ μ‚¬μ©ν•λ‹¤. 

μ΄λ“¤ λ©”μ„λ“λ” mapκ³Ό μ •ν™•ν κ°™μ€ κΈ°λ¥μ„ μν–‰ν•μ§€λ§, Stream<T> λ€μ‹  νΉν™”λ μ¤νΈλ¦Όμ„ λ°ν™ν•λ‹¤.

```java
int calories = menu.stream()
                   // IntStream λ°ν™
                   .mapToInt(Dish::getCalories)
                   .sum();
```

`mapInt` λ©”μ„λ“λ” κ° μ”λ¦¬μ—μ„ λ¨λ“  μΉΌλ΅λ¦¬(Integer)λ¥Ό μ¶”μ¶ν• λ‹¤μμ— `Stream<Integer>`κ°€ μ•„λ‹λΌ `IntStream`μ„ λ°ν™ν•λ‹¤. λ”°λΌμ„ IntStream μΈν„°νμ΄μ¤μ—μ„ μ κ³µν•λ” sum λ©”μ„λ“λ¥Ό μ΄μ©ν•΄μ„ μΉΌλ΅λ¦¬ ν•©κ³„λ¥Ό κ³„μ‚°ν•  μ μλ‹¤.

μ¤νΈλ¦Όμ΄ λΉ„μ–΄μμΌλ©΄ sumμ€ κΈ°λ³Έκ°’ 0μ„ λ°ν™ν•λ‹¤. 

IntStreamμ€ max, min, average λ“± λ‹¤μ–‘ν• μ ν‹Έλ¦¬ν‹° λ©”μ„λ“λ„ μ§€μ›ν•λ‹¤.

<br>

### π“ κ°μ²΄ μ¤νΈλ¦ΌμΌλ΅ λ³µμ›ν•κΈ°

μ«μ μ¤νΈλ¦Όμ„ λ§λ“  λ‹¤μμ—, μ›μƒνƒμΈ νΉν™”λμ§€ μ•μ€ μ¤νΈλ¦ΌμΌλ΅ λ³µμ›ν•  μ μμ„κΉ? 

μλ¥Ό λ“¤μ–΄, IntStreamμ€ κΈ°λ³Έν•μ μ •μκ°’λ§ λ§λ“¤ μ μλ‹¤. IntStreamμ map μ—°μ‚°μ€ β€intλ¥Ό μΈμλ΅ λ°›μ•„μ„ intλ¥Ό λ°ν™ν•λ” λλ‹¤β€™λ¥Ό μΈμλ΅ λ°›λ”λ‹¤. 

ν•μ§€λ§ μ •μκ°€ μ•„λ‹ λ‹¤λ¥Έ κ°’μ„ λ°ν™ν•κ³  μ‹¶μΌλ©΄ μ–΄λ–»κ² ν•΄μ•Όν• κΉ? κ·Έλ¬λ ¤λ©΄ μ¤νΈλ¦Ό μΈν„°νμ΄μ¤μ— μ •μλ μΌλ°μ μΈ μ—°μ‚°μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤. 

λ‹¤μ μμ μ²λΌ `boxed` λ©”μ„λ“λ¥Ό μ΄μ©ν•΄μ„ νΉν™” μ¤νΈλ¦Όμ„ μΌλ° μ¤νΈλ¦ΌμΌλ΅ λ³€ν™ν•  μ μλ‹¤.

```java
// μ¤νΈλ¦Όμ„ μ«μ μ¤νΈλ¦ΌμΌλ΅ λ³€ν™
IntStream intStream = menu.Stream().mapToInt(Dish::getCalories);
// μ«μ μ¤νΈλ¦Όμ„ μ¤νΈλ¦ΌμΌλ΅ λ³€ν™
Stream<Integer> stream = intStream().boxed();
```

<br>

### π“ κΈ°λ³Έκ°’ : OptionalInt

IntStreamμ—μ„ μµλ“κ°’μ„ μ°Ύμ„ λ•λ” 0μ΄λΌλ” κΈ°λ³Έκ°’ λ•λ¬Έμ— μλ»λ κ²°κ³Όκ°€ λ„μ¶λ  μ μλ‹¤. μ¤νΈλ¦Όμ— μ”μ†κ°€ μ—†λ” μƒν™©κ³Ό μ‹¤μ  μµλ“κ°’μ΄ 0μΈ μƒν™©μ„ μ–΄λ–»κ² κµ¬λ³„ν•  μ μμ„κΉ? 

κ°’μ΄ μ΅΄μ¬ν•λ” μ§€ μ—¬λ¶€λ¥Ό κ°€λ¦¬ν‚¬ μ μλ” μ»¨ν…μ΄λ„ ν΄λμ¤ `Optional`μ„ Integer, String λ“±μ μ°Έμ΅° ν•μ‹μΌλ΅ νλΌλ―Έν„°ν™”ν•  μ μλ‹¤. λν• `OptionalInt`, `OptionalDouble`, `OptionalLong` μ„Έ κ°€μ§€ κΈ°λ³Έν• νΉν™” μ¤νΈλ¦Ό λ²„μ „λ„ μ κ³µν•λ‹¤.

μλ¥Ό λ“¤μ–΄ λ‹¤μμ²λΌ `OptionalInt`λ¥Ό μ΄μ©ν•΄μ„ IntStreamμ μµλ“κ°’ μ”μ†λ¥Ό μ°Ύμ„ μ μκ³ , μµλ“κ°’μ΄ μ—†λ” μƒν™©μ— μ‚¬μ©ν•  κΈ°λ³Έκ°’μ„ λ…μ‹μ μΌλ΅ μ •μν•  μ μλ‹¤.

```java
OptionalInt maxCalories = menu.stream()
                              .mapToInt(Dish::getCalories)
                              .max();

// κ°’μ΄ μ—†μ„ λ• κΈ°λ³Έ μµλ“κ°’μ„ λ…μ‹μ μΌλ΅ μ„¤μ •
int max = maxCalories.orElse(1);
```

<br>

## π’΅ 5.7.2 μ«μ λ²”μ„

μλ¥Ό λ“¤μ–΄ 1μ—μ„ 100κΉμ§€μ μ«μλ¥Ό μƒμ„±ν•λ ¤ ν•λ‹¤κ³  κ°€μ •ν•μ. 

μλ°” 8μ IntStreamκ³Ό LongStreamμ—μ„λ” `range`μ™€ `rangeClosed`λΌλ” λ‘ κ°€μ§€ μ •μ  λ©”μ„λ“λ¥Ό μ κ³µν•λ‹¤. 

- λ‘ λ©”μ„λ“ λ¨λ‘ μ²« λ²μ§Έ μΈμλ΅ μ‹μ‘κ°’, λ‘ λ²μ§Έ μΈμλ΅ μΆ…λ£κ°’μ„ κ°€μ§„λ‹¤.
- `range` λ©”μ„λ“λ” μ‹μ‘κ°’κ³Ό μΆ…λ£κ°’μ΄ κ²°κ³Όμ— ν¬ν•¨λμ§€ μ•λ”λ‹¤.
- `rangeClosed` λ©”μ„λ“λ” μ‹μ‘κ°’κ³Ό μΆ…λ£κ°’μ΄ κ²°κ³Όμ— ν¬ν•¨λλ‹¤.

λ‹¤μ μμ λ¥Ό μ‚΄ν΄λ³΄μ.

```java
// [1, 100]μ λ²”μ„λ¥Ό λ‚νƒ€λ‚Έλ‹¤.
IntStream evenNumbers = IntStream.rangeClosed(1, 100)
                                 // 1λ¶€ν„° 100κΉμ§€μ μ§μ μ¤νΈλ¦Ό
                                 .filter(n -> n % 2 == 0);
// 1λ¶€ν„° 100κΉμ§€μ—λ” 50κ°μ μ§μκ°€ μλ‹¤.
System.out.println(evenNumbers.count());
```

μ„ μ½”λ“μ²λΌ `rangeClosed`λ¥Ό μ΄μ©ν•΄μ„ 1λ¶€ν„° 100κΉμ§€μ μ«μλ¥Ό λ§λ“¤ μ μλ‹¤. 

`rangeClosed`μ κ²°κ³Όλ” μ¤νΈλ¦ΌμΌλ΅ filter λ©”μ„λ“λ¥Ό μ΄μ©ν•΄μ„ μ§μλ§ ν•„ν„°λ§ν•  μ μλ‹¤. filterλ¥Ό νΈμ¶ν•΄λ„ μ‹¤μ λ΅λ” μ•„λ¬΄ κ³„μ‚°λ„ μ΄λ£¨μ–΄μ§€μ§€ μ•λ”λ‹¤. 

μµμΆ…μ μΌλ΅ κ²°κ³Ό μ¤νΈλ¦Όμ— countλ¥Ό νΈμ¶ν•λ‹¤. countλ” μµμΆ… μ—°μ‚°μ΄λ―€λ΅ μ¤νΈλ¦Όμ„ μ²λ¦¬ν•΄μ„ 1λ¶€ν„° 100κΉμ§€μ μ«μ λ²”μ„μ—μ„ μ§μ 50κ°λ¥Ό λ°ν™ν•λ‹¤. 

`rangeClosed` λ€μ‹ μ— `IntStream.range(1, 100)`μ„ μ‚¬μ©ν•λ‹¤λ©΄ 1κ³Ό 100μ„ ν¬ν•¨ν•μ§€ μ•μΌλ―€λ΅ μ§μ 49κ°λ¥Ό λ°ν™ν•λ‹¤.
